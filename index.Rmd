---
title: "Introducing {surveydown}"
subtitle: "An open-source platform for programmable, markdown-based surveys"
date: "posit::conf(2025)"
author: "John Paul Helveston"
institute: "The George Washington University | Dept. of Engineering Management and Systems Engineering"
output:
  xaringan::moon_reader:
    css:
      - default
      - css/lexis.css
      - css/lexis-fonts.css
      - css/surveydown.css
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---

```{r setup, include=FALSE}
library(knitr)
library(fontawesome)
library(metathis)
library(surveydown)

options(
    htmltools.dir.version = FALSE,
    knitr.table.format = "html",
    knitr.kable.NA = '',
    dplyr.width = Inf,
    width = 250
)
knitr::opts_chunk$set(
    warning = FALSE,
    message = FALSE,
    fig.path = "figs/",
    fig.width = 7.252,
    fig.height = 4,
    comment = "#>",
    fig.retina = 3
)

# Setup xaringanExtra options
xaringanExtra::use_xaringan_extra(c(
  "tile_view", "panelset", "share_again"))
xaringanExtra::style_share_again(share_buttons = "none")
xaringanExtra::use_extra_styles(
  mute_unhighlighted_code = FALSE
)

# Set up website metadata
meta() %>%
  meta_general(
    description = rmarkdown::metadata$subtitle,
    generator = "xaringan and remark.js"
  ) %>%
  meta_name("github-repo" = "jhelvy/2025-posit-conf-surveydown") %>%
  meta_social(
    title = rmarkdown::metadata$title,
    url = "https://www.jhelvy.com/slides",
    og_type = "website",
    og_author = "John Paul Helveston",
    twitter_card_type = "summary_large_image"
  )
```

background-image: url("images/blue.jpg")
background-size: cover
class: inverse

<br><br><br><br>

## `r rmarkdown::metadata$title`

### `r rmarkdown::metadata$subtitle`

<br><br><br><br>

**.white[John Paul Helveston]**, George Washington University

`r rmarkdown::metadata$date`

---

class: center, middle

<center>
<img src="images/demo.gif" width=70%>
</center>

---

background-image: url("images/images/Slide1.png")
background-size: cover

---

background-image: url("images/images/Slide2.png")
background-size: cover

---

background-image: url("images/images/Slide3.png")
background-size: cover

---

background-image: url("images/images/Slide4.png")
background-size: cover

---

background-image: url("images/images/Slide5.png")
background-size: cover

---

background-image: url("images/images/Slide6.png")
background-size: cover

---

background-image: url("images/images/Slide7.png")
background-size: cover

---

background-image: url("images/images/Slide8.png")
background-size: cover

---

class: center, middle, inverse

# Wouldn't it be nice if there was a<br>"Quarto" for surveys?

--

<center>
<img src="images/logo_surveydown.png" width=300>
</center>

---

class: middle 

.leftcol40[

# In this talk,<br>you'll learn:

]

.rightcol60[

## - What is `surveydown`?

## - How does it work?

## - What can I do with it?

## - What's next?

]

---

class: center, middle, inverse

# What is `surveydown`?

---

background-image: url("images/images/Slide9.png")
background-size: cover

---

.leftcol[.code75[

````{markdown}
---
format: html
echo: false
warning: false
---

```{r}
library(surveydown)
```

::: {.sd_page id=welcome}

# Welcome to our survey!

```{r}
sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite super hero?", 
  option = c("Yes" = "yes", "No" = "no")
)

sd_next()
```

:::
````

]]

.rightcol[

.center[`survey.qmd` --> Rendered survey]

<center>
<img src="images/survey-app.png" width=100%>
</center>

]

---

.leftcol[.code75[

````{markdown}
--- #<<
format: html #<<
echo: false #<<
warning: false #<<
--- #<<

```{r}
library(surveydown)
```

::: {.sd_page id=welcome}

# Welcome to our survey!

```{r}
sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite super hero?", 
  option = c("Yes" = "yes", "No" = "no")
)

sd_next()
```

:::
````

]]

.rightcol[

### .center[Standard YAML header<br>w/options for "clean" output]

]

---

.leftcol[.code75[

````{markdown}
---
format: html
echo: false
warning: false
---

```{r} #<<
library(surveydown) #<<
``` #<<

::: {.sd_page id=welcome}

# Welcome to our survey!

```{r}
sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite super hero?", 
  option = c("Yes" = "yes", "No" = "no")
)

sd_next()
```

:::
````

]]

.rightcol[

<br><br><br>

### .center[Load the `surveydown` package]

]

---

.leftcol[.code75[

````{markdown}
---
format: html
echo: false
warning: false
---

```{r}
library(surveydown) 
```

::: {.sd_page id=welcome} #<<

# Welcome to our survey!

```{r}
sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite super hero?", 
  option = c("Yes" = "yes", "No" = "no")
)

sd_next()
```

::: #<<
````

]]

.rightcol[

<br><br><br><br><br><br>

### .center[Use Quarto fences (`:::`)<br>to define survey pages]

]

---

.leftcol[.code75[

````{markdown}
---
format: html
echo: false
warning: false
---

```{r}
library(surveydown) 
```

::: {.sd_page id=welcome} 

# Welcome to our survey! #<<
   #<<
```{r} #<<
sd_question( #<<
  type  = "mc", #<<
  id    = "has_fav_hero", #<<
  label = "Do you have a favorite super hero?",  #<<
  option = c("Yes" = "yes", "No" = "no") #<<
) #<<
   #<<
sd_next() #<<
``` #<<

::: 
````

]]

.rightcol[

<br><br><br><br><br><br><br><br>

### .center[Page content]

- Markdown for page content (text, images, etc.)
- `sd_question()` for survey questions
- `sd_next()` for next button

]

---

.leftcol[.code75[

````{markdown}
---
format: html
echo: false
warning: false
---

```{r}
library(surveydown)
```

::: {.sd_page id=welcome}

# Welcome to our survey!

```{r}
sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite super hero?", 
  option = c("Yes" = "yes", "No" = "no")
)

sd_next()
```

:::
````

]]

.rightcol[

.center[`survey.qmd` --> Rendered survey]

<center>
<img src="images/survey-app.png" width=100%>
</center>

]

---

class: middle, inverse

# .center[Wait a minute...<br>Quarto renders to _static_ html pages, right?]

<center>
<img src="images/batman-think.gif" width=40%>
</center>

---

class: middle, inverse

# .font150[.center[Shiny to the rescue!]]

.leftcol[

<center>
<img src="images/logo_shiny.png" width=60%>
</center>

]

.rightcol[
<center>
<img src="images/batman-thumbs-up.gif" width=70%>
</center>

]

---

background-image: url("images/images/Slide10.png")
background-size: cover

---

background-image: url("images/images/Slide11.png")
background-size: cover

---

background-image: url("images/images/Slide12.png")
background-size: cover

---

class: center

# A complete `surveydown` survey

<br>

.leftcol45[

### `survey.qmd` 

.font120[A **Quarto doc** defining the survey content (pages, text, images, questions, etc).]

]

.rightcol55[

### `app.R` 

.font120[An **R script** defining the<br>survey Shiny app.]

]

---

.leftcol65[.code90[

Typical `app.R` file

```{r}
#| eval: false

library(surveydown)

ui <- sd_ui() 

server <- function(input, output, session) { 
  
  sd_server()
   
} 

shiny::shinyApp(ui = ui, server = server)
```

]]

---

.leftcol65[.code90[

Typical `app.R` file

```{r}
#| eval: false

library(surveydown)

ui <- sd_ui() #<<

server <- function(input, output, session) { 
  
  sd_server() #<<
   
} 

shiny::shinyApp(ui = ui, server = server)
```

]]

.rightcol35[

<br><br><br>

Render the `survey.qmd` file

<br>

Run the surveydown server

]

---

class: middle, inverse

# .center[Wait a minute...<br>How do you store the response data?]

<center>
<img src="images/superman-think.gif" width=50%>
</center>

---

class: middle, inverse

# .font150[.center[PostgreSQL to the rescue!]]

.leftcol[

<center>
<img src="images/logo_postgres.png" width=60%>
</center>

]

.rightcol[

<img src="images/superman-oh-yeah.gif" width=60%>

]

---

.leftcol65[.code90[

Typical `app.R` file

```{r}
#| eval: false

library(surveydown)

# sd_db_config() #<<
db <- sd_db_connect() #<<

ui <- sd_ui() 

server <- function(input, output, session) { 
  
  sd_server(db) #<<
   
} 

shiny::shinyApp(ui = ui, server = server)
```

]]

.rightcol35[

<br><br><br>

Store credentials<br>
Connect to the database

<br>

Pass connection to `sd_server()`

]

---

class: center, middle

.leftcol20[

### supabase.com

<center>
<img src="images/logo_supabase.png" width=80%>
</center>

]

.rightcol80[

<center>
<img src="images/supabase-table.png" width=100%>
</center>

]

---

class: middle, inverse, center

# What can `surveydown` do?

---

## .center[Surveydown supports most common survey features]

<br><br>

.leftcol25[]

.rightcol75[

## - Lots of question types

## - Conditionally display content

## - Conditionally skip forward

]

---

START!

---

# .center[Question types: `text`]

<br>

.leftcol[

```{r}
#| eval: false
sd_question(
  type  = "text",
  id    = "fav_hero_name",
  label = "Who is your favorite super hero?"
)
```

]

.rightcol[

<center>
<img src="images/question-text.png" width=100%>
</center>

]

---

# .center[Question types: `mc`]

<br>

.leftcol[

```{r}
#| eval: false
sd_question(
  type  = "mc",
  id    = "hero_universe",
  label = "Which superhero universe do you prefer?",
  option = c(
    "Marvel" = "marvel",
    "DC Comics" = "dc",
    "Independent/Other" = "other",
    "I like them all equally" = "all"
  )
)
```

]

.rightcol[

<center>
<img src="images/question-mc.png" width=100%>
</center>

]

---

# .center[Question types: `mc_multiple`]

<br>

.leftcol[

```{r}
#| eval: false
sd_question(
  type  = "mc_multiple",
  id    = "hero_qualities",
  label = "What qualities do you find most appealing? (Select all that apply)",
  option = c(
    "Super strength" = "strength",
    "Ability to fly" = "flying",
    "Intelligence/Strategy" = "intelligence",
    "Humor/Wit" = "humor",
    "Moral compass" = "morals"
  )
)
```

]

.rightcol[

<center>
<img src="images/question-mc-multiple.png" width=100%>
</center>

]

---

# .center[Question types: `mc_buttons`]

<br>

.leftcol[
```{r}
#| eval: false
sd_question(
  type  = "mc_buttons",
  id    = "dream_power",
  label = "If you could have ONE superpower?",
  option = c(
    "üï∏Ô∏è Web-slinging" = "webslinging",
    "üõ°Ô∏è Super Strength" = "strength",
    "‚úàÔ∏è Flight" = "flight",
    "üß† Telepathy" = "telepathy",
    "‚ö° Super Speed" = "speed"
  ),
  direction = "vertical"
)
```

]

.rightcol[

<center>
<img src="images/question-mc-buttons.png" width=100%>
</center>

]

---

# .center[Question types: `slider_numeric`]

<br>

.leftcol[

```{r}
#| eval: false
sd_question(
  type  = "slider_numeric",
  id    = "responsibility_scale",
  label = "How much do you agree with 'With great power comes great responsibility'?",
  option = 1:10
)
```

]

.rightcol[

<center>
<img src="images/question-slider.png" width=100%>
</center>

]

---

class: center

# Conditionally display content

<center>
<img src="images/conditional-display.gif" width=50%>
</center>

---

# .center[Conditionally display content]

.leftcol[

survey.qmd

```{r}
#| eval: false

sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite hero?",
  option = c("Yes" = "yes", "No" = "no")
)

sd_question(
  type  = "text",
  id    = "fav_hero",
  label = "Who is your favorite super hero?"
)
```

app.R

```{r}
#| eval: false

sd_show_if(
  input$has_fav_hero == "yes" ~ "fav_hero"
)
```

]

.rightcol[

<br>
<center>
<img src="images/conditional-display.gif" width=100%>
</center>

]

---

# .center[Conditionally skip forward]

<center>
<img src="images/screenout.gif" width=60%>
</center>

---

# .center[Conditionally skip forward]

.leftcol[

survey.qmd

```{r}
#| eval: false

sd_question(
  type  = "mc",
  id    = "has_fav_hero",
  label = "Do you have a favorite hero?",
  option = c("Yes" = "yes", "No" = "no")
)
```

app.R

```{r}
#| eval: false

sd_skip_forward(
  input$has_fav_hero == "no" ~ "screenout"
)
```

]

.rightcol[

<br>
<center>
<img src="images/screenout.gif" width=100%>
</center>

] 

---

class: center, middle, inverse

# If it works in Shiny,<br>it works in surveydown

---

.leftcol40[

# Embed interactive map using {leaflet}

]

.rightcol60[

<center>
<iframe src="images/map.mp4" width="762" height="610" frameborder="0" allowfullscreen>
</iframe>
</center>

]

---

class: center

## Generate surveys with LLMs!

<center>
<img src="images/llm.gif" width=80%>
</center>

---

class: center, middle, inverse

# What's next?

---

class: center, middle

# Try out the surveydown [studio app](https://github.com/surveydown-dev/sdApps)

## `sdApps::sd_studio()`

---

Check out the paper

---

class: middle, center 

# You can help!

---

class: inverse 
background-image: url("images/blue.jpg")
background-size: cover

<br>

# Thanks!

<br>

### <span class="white-text">https://jhelvy.github.io/2025-posit-conf-surveydown</span>

<style>
.white-text a {
  color: white !important;
}
</style>

.footer-large[.white[.right[

@jhelvy.bsky.social `r fa(name = "bluesky", fill = "white")`<br>
@jhelvy `r fa(name = "github", fill = "white")`<br>
jhelvy.com `r fa(name = "link", fill = "white")`<br>
jph@gwu.edu `r fa(name = "paper-plane", fill = "white")`

]]]
